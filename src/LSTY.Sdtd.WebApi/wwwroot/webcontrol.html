<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <!-- import CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/element-ui@2.15.7/lib/theme-chalk/index.min.css" />
    <style>
        body {
            width: 100vw;
            height: 100vh;
            margin: 0;
        }

        #app {
            width: 100%;
            height: 100%;
        }

        .el-container {
            width: 100%;
            height: 100%;
        }

        .el-aside {
            background-color: rgb(0, 21, 41);
        }
    </style>
</head>

<body>
    <div id="app">
        <el-container>
            <el-aside width="200px">Aside</el-aside>
            <el-container>
                <el-header>Header</el-header>
                <el-main>Main</el-main>
                <el-footer>Footer</el-footer>
            </el-container>
        </el-container>
    </div>
</body>
<!-- import Vue before Element -->
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"></script>
<!-- import JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/element-ui@2.15.7/lib/index.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/signalr@2.4.2/jquery.signalR.min.js"></script>
<script>
    new Vue({
        el: "#app",
        data() {
            return {
                signalRUrl: "http://localhost:8888",
                connection: null,
                access_token: null,
            };
        },
        created() {
            this.init();
        },
        methods: {
            init() {
                var connection = $.hubConnection(this.signalRUrl);
                connection.logging = true;

                if (this.access_token) {
                    connection.qs = { 'access-token': this.access_token };
                }

                connection.error(function (error) {
                    console.log('SignalR error: ' + error)
                });
                var serverManageHubProxy = connection.createHubProxy('IServerManageHub');
                var modEventHookHubProxy = connection.createHubProxy('IModEventHookHub');
                modEventHookHubProxy.on('OnLogCallback', function (message) {
                    console.log(message);
                });
                connection.start({ transport: ['webSockets'] })
                    .done(function () {
                        console.log('Now connected, connection ID=' + connection.id);
                        serverManageHubProxy.invoke('ExecuteConsoleCommand', 'say hello', false);
                    })
                    .fail(function () { console.log('Could not connect'); });

                this.connection = connection;
            },
            sendMsg() {
                let params = {
                    user: this.user,
                    message: this.message
                };
                this.connection.invoke("SendMessage", params);
            }
        },
    });
</script>

</html>